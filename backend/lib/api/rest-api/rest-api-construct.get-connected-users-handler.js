"use strict";
Object.defineProperty(exports, "__esModule", { value: true });
exports.handler = void 0;
const dynamodb_1 = require("../../util/dynamodb");
const handler = async ( /*event: APIGatewayProxyEvent*/) => {
    const connectionTable = process.env.CONNECTION_TABLE_NAME || (() => { throw new Error('No connection table name supplied'); })();
    console.log('Querying connection ids');
    const connectedUserNames = (await (0, dynamodb_1.scanComplete)({ TableName: connectionTable })).map((item) => item.name);
    console.log('Connected users: ' + connectedUserNames);
    return {
        statusCode: 200,
        headers: { 'Access-Control-Allow-Origin': '*' },
        body: JSON.stringify({ connectedUserNames })
    };
};
exports.handler = handler;
//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoicmVzdC1hcGktY29uc3RydWN0LmdldC1jb25uZWN0ZWQtdXNlcnMtaGFuZGxlci5qcyIsInNvdXJjZVJvb3QiOiIiLCJzb3VyY2VzIjpbInJlc3QtYXBpLWNvbnN0cnVjdC5nZXQtY29ubmVjdGVkLXVzZXJzLWhhbmRsZXIudHMiXSwibmFtZXMiOltdLCJtYXBwaW5ncyI6Ijs7O0FBR0Esa0RBQW1EO0FBRzVDLE1BQU0sT0FBTyxHQUFHLEtBQUssR0FBRSwrQkFBK0IsRUFBb0MsRUFBRTtJQUMvRixNQUFNLGVBQWUsR0FBRyxPQUFPLENBQUMsR0FBRyxDQUFDLHFCQUFxQixJQUFJLENBQUMsR0FBRyxFQUFFLEdBQUcsTUFBTSxJQUFJLEtBQUssQ0FBQyxtQ0FBbUMsQ0FBQyxDQUFBLENBQUMsQ0FBQyxDQUFDLEVBQUUsQ0FBQTtJQUMvSCxPQUFPLENBQUMsR0FBRyxDQUFDLHlCQUF5QixDQUFDLENBQUM7SUFDdkMsTUFBTSxrQkFBa0IsR0FBRyxDQUFDLE1BQU0sSUFBQSx1QkFBWSxFQUFDLEVBQUUsU0FBUyxFQUFFLGVBQWUsRUFBRSxDQUFDLENBQUMsQ0FBQyxHQUFHLENBQUMsQ0FBQyxJQUFrQixFQUFFLEVBQUUsQ0FBRSxJQUE0QixDQUFDLElBQUksQ0FBQyxDQUFDO0lBQ2hKLE9BQU8sQ0FBQyxHQUFHLENBQUMsbUJBQW1CLEdBQUcsa0JBQWtCLENBQUMsQ0FBQztJQUV0RCxPQUFPO1FBQ0gsVUFBVSxFQUFFLEdBQUc7UUFDZixPQUFPLEVBQUUsRUFBRSw2QkFBNkIsRUFBRSxHQUFHLEVBQUU7UUFDL0MsSUFBSSxFQUFFLElBQUksQ0FBQyxTQUFTLENBQUMsRUFBRSxrQkFBa0IsRUFBRSxDQUFDO0tBQy9DLENBQUM7QUFFTixDQUFDLENBQUE7QUFaWSxRQUFBLE9BQU8sV0FZbkIiLCJzb3VyY2VzQ29udGVudCI6WyJpbXBvcnQgeyBBUElHYXRld2F5UHJveHlSZXN1bHRWMiB9IGZyb20gJ2F3cy1sYW1iZGEnXG5pbXBvcnQgeyBBdHRyaWJ1dGVNYXAgfSBmcm9tICdhd3Mtc2RrL2NsaWVudHMvZHluYW1vZGInO1xuaW1wb3J0IHsgQ29ubmVjdGlvblRhYmxlSXRlbSB9IGZyb20gJy4uLy4uL2RhdGFtb2RlbC9jb25uZWN0aW9uLXRhYmxlJztcbmltcG9ydCB7IHNjYW5Db21wbGV0ZSB9IGZyb20gJy4uLy4uL3V0aWwvZHluYW1vZGInO1xuXG5cbmV4cG9ydCBjb25zdCBoYW5kbGVyID0gYXN5bmMgKC8qZXZlbnQ6IEFQSUdhdGV3YXlQcm94eUV2ZW50Ki8pOiBQcm9taXNlPEFQSUdhdGV3YXlQcm94eVJlc3VsdFYyPiA9PiB7XG4gICAgY29uc3QgY29ubmVjdGlvblRhYmxlID0gcHJvY2Vzcy5lbnYuQ09OTkVDVElPTl9UQUJMRV9OQU1FIHx8ICgoKSA9PiB7IHRocm93IG5ldyBFcnJvcignTm8gY29ubmVjdGlvbiB0YWJsZSBuYW1lIHN1cHBsaWVkJykgfSkoKVxuICAgIGNvbnNvbGUubG9nKCdRdWVyeWluZyBjb25uZWN0aW9uIGlkcycpO1xuICAgIGNvbnN0IGNvbm5lY3RlZFVzZXJOYW1lcyA9IChhd2FpdCBzY2FuQ29tcGxldGUoeyBUYWJsZU5hbWU6IGNvbm5lY3Rpb25UYWJsZSB9KSkubWFwKChpdGVtOiBBdHRyaWJ1dGVNYXApID0+IChpdGVtIGFzIENvbm5lY3Rpb25UYWJsZUl0ZW0pLm5hbWUpO1xuICAgIGNvbnNvbGUubG9nKCdDb25uZWN0ZWQgdXNlcnM6ICcgKyBjb25uZWN0ZWRVc2VyTmFtZXMpO1xuXG4gICAgcmV0dXJuIHtcbiAgICAgICAgc3RhdHVzQ29kZTogMjAwLFxuICAgICAgICBoZWFkZXJzOiB7ICdBY2Nlc3MtQ29udHJvbC1BbGxvdy1PcmlnaW4nOiAnKicgfSxcbiAgICAgICAgYm9keTogSlNPTi5zdHJpbmdpZnkoeyBjb25uZWN0ZWRVc2VyTmFtZXMgfSlcbiAgICB9O1xuXG59Il19